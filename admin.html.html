<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Agenda Semanal - Admin</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f0f2f5;
      margin: 0;
      padding: 20px;
    }

    h1 {
      text-align: center;
      color: #333;
    }

    .agenda {
      display: grid;
      grid-template-columns: 100px repeat(7, 1fr);
      border: 1px solid #ccc;
      background: white;
      border-radius: 8px;
      overflow: auto;
    }

    .header, .cell, .time {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: center;
    }

    .header {
      background: #007bff;
      color: white;
      font-weight: bold;
    }

    .time {
      background: #f8f9fa;
      font-weight: bold;
    }

    .cell {
      min-height: 60px;
      background: #fff;
      font-size: 0.9rem;
    }

    .agendamento {
      background: #e9ecef;
      margin: 2px 0;
      padding: 5px;
      border-radius: 4px;
    }

    .vazio {
      color: #bbb;
      font-style: italic;
    }
  </style>
</head>
<body>
  <h1>ðŸ“… Agenda Semanal (Admin)</h1>
  <div class="agenda" id="tabelaAgenda">
    <!-- A tabela serÃ¡ gerada via JavaScript -->
  </div>

  <script>
    const diasSemana = ['Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'SÃ¡b', 'Dom'];
    const horarios = Array.from({ length: 20 }, (_, i) => {
      const h = 8 + Math.floor(i / 2);
      const m = i % 2 === 0 ? '00' : '30';
      return `${String(h).padStart(2, '0')}:${m}`;
    });

    function gerarAgenda() {
      const tabela = document.getElementById('tabelaAgenda');
      tabela.innerHTML = '';

      // Linha de cabeÃ§alho
      tabela.appendChild(criarCelula('', 'header'));
      diasSemana.forEach(dia => {
        tabela.appendChild(criarCelula(dia, 'header'));
      });

      const agendamentos = JSON.parse(localStorage.getItem('agendamentos') || '[]');

      // GeraÃ§Ã£o da tabela
      horarios.forEach(horario => {
        tabela.appendChild(criarCelula(horario, 'time'));

        diasSemana.forEach((dia, index) => {
          const hoje = new Date();
          const inicioSemana = new Date(hoje.setDate(hoje.getDate() - hoje.getDay() + 1)); // segunda
          const dataRef = new Date(inicioSemana);
          dataRef.setDate(inicioSemana.getDate() + index);
          const dataISO = dataRef.toISOString().split('T')[0];

          const agendados = agendamentos.filter(ag => ag.data === dataISO && ag.hora === horario);

          const celula = document.createElement('div');
          celula.classList.add('cell');

          if (agendados.length > 0) {
            agendados.forEach(ag => {
              const bloco = document.createElement('div');
              bloco.classList.add('agendamento');
              bloco.innerHTML = `<strong>${ag.nome}</strong><br><small>${ag.servico}</small>`;
              celula.appendChild(bloco);
            });
          } else {
            celula.innerHTML = `<span class="vazio">-</span>`;
          }

          tabela.appendChild(celula);
        });
      });
    }

    function criarCelula(texto, classe) {
      const div = document.createElement('div');
      div.className = classe;
      div.textContent = texto;
      return div;
    }

    gerarAgenda();
  </script>
</body>
</html>
